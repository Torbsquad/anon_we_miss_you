<link rel="stylesheet" type="text/css" href="./index.css" />
<script src="/axios.js"></script>

<input id="searchbox" type="text" />
<div id="main-container"></div>

<script>
  var mainContainer = document.getElementById('main-container')
  var currentSearch = ''
  var typingSearch = ''

  async function init() {
    let emojis = await axios.get('https://api.vnft.cc/emoji/lead/0')
    for (let emoji of emojis.data) {
      let emojiElement = createEmojiElement(emoji)
      mainContainer.appendChild(emojiElement)
    }
    setInterval(loop, 500)
  }

  async function loop() {
    let searchbox = document.getElementById('searchbox')
    if (currentSearch != searchbox.value) {
      if (typingSearch == searchbox.value) {
        mainContainer.innerHTML = ''
        currentSearch = searchbox.value
        let page = 0
        let emojis = await axios.get(`https://api.vnft.cc/emoji/search/${searchbox.value}/${page}`)
        for (let emoji of emojis.data) {
          let emojiElement = createEmojiElement(emoji)
          mainContainer.appendChild(emojiElement)
        }
      }
      typingSearch = searchbox.value
    }
  }

  function createEmojiElement(emoji){
    let div = document.createElement('div')
    let el = document.createElement('img')
    div.appendChild(el)
    
    div.className = "img"
    el.className = "parent"

    el.src = emoji.url
    el.title = emoji.name

    return div
  }

  init()
</script>
